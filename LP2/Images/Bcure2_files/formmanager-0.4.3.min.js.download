var FormManager=function(A,f){var B=null;var q="undefined";this.VALIDATION_TYPE_NONE="none";this.ATTR_MIN_LENGTH="minchars";this.ATTR_VALIDATION_TYPE="vtype";this.ATTR_REQUIRE="require";this.SELECTBOX_NO_VALUE="noValue";this.ATTR_ERROR_ELEMENT="error-element";this.ERROR_ELEMENT_SUFFIX="error";this.ATTR_ERROR_MESSAGE_ELEMENT="error-msg-element";this.ATTR_PREFIX="prefix";var w=this;this.ERROR_REQUIRED="required";this.ERROR_INVALID="invalid";this.ERROR_SHORT="short";this.ERROR_DIFFERENT="different";
this.ERROR_FILE_SIZE="file_size";this.ERROR_FILE_TYPE="file_type";this.ERROR_PASSWORD_FORMAT="format";var l=null;this.getFormElement=function(){return B};var s=function(D){if(typeof(D)=="object"&&D.tagName.toLowerCase()=="form"){B=$(D)}else{if(D!=""){var C="form#"+D;var E=$(C);if(E.length==1){B=E}}}if(B==null){throw"invalid form"}};var t=function(H,F,D,E,C){var G=F.data("title")||F.attr("id")||"";if(G!=""){H=G+": "+H}if(E!=C){H+="<br />"}return H};var e=function(){return true};var i=function(C){var D=$(C);
if($(C).data(w.ATTR_ERROR_ELEMENT)){D=$($(C).data(w.ATTR_ERROR_ELEMENT))}return D};var g=function(D){var E=$(D).is("input[type=radio]")?$(D).attr("name"):$(D).attr("id");var C=$("#"+E+"_"+w.ERROR_ELEMENT_SUFFIX+"."+x.errorMessageClass);if($(D).data(w.ATTR_ERROR_MESSAGE_ELEMENT)){C=$($(D).data(w.ATTR_ERROR_MESSAGE_ELEMENT))}return C};var x={clearErrorsOnChange:true,validateOnKeyPress:false,requestType:"POST",httpsCheck:true,serverURL:"tasks.php",elementError:e,valid:e,invalid:e,success:e,successVisual:null,error:e,errorClass:"error",checkboxCheckedValue:"1",checkboxNotCheckedValue:"0",errorMessageClass:"error-msg",skipValidationClass:"skip-validation",errorsHolder:null,errorHolderRowFactory:t,errorRequiredText:"שדה חובה",errorInvalidText:"לא תקין",errorShortText:"מינימום %s תווים",errorDifferent:"לא תואם",errorFileSize:"קובץ גדול מדי",errorFileType:"סוג קובץ לא תקין",errorPasswordFormat:{digit:"חייב להכיל ספרה",lower:"חייב להכיל אות קטנה",upper:"חייב להכיל אות גדולה",punc:"חייב להכיל סימן"},sendEmptyOptionalField:false,sendFormOnValidation:true,getErrorElement:i,getMessageElement:g};
f=f||{};x=$.extend(x,f);var n=function(C){return typeof(C)!==q};var z=function(C){return FormManager.validateElem(C,true,w)};var a=function(F){var C=F.data("dependency");if(C!==undefined&&C!=""){var D=F.data("dependency");var G=$("#"+D+",input[type=radio][name="+D+"]:checked").val();var E=F.data("dependency-value");return G==E}return true};var b=function(D){var E="";for(var C in x.errorPasswordFormat){if(D.indexOf(" #"+C+"#")>-1){if(E!=""){E+="<br />"}E+=x.errorPasswordFormat[C]}}return E};var v=function(C){return{messageElem:x.getMessageElement(C),errorElem:x.getErrorElement(C)}
};var c=function(C,E){var G="";var F=C.split(" ")[0];var D=$(E).data("error-messages");if(D&&typeof(D[F])!="undefined"){G=D[F]}else{switch(F){case w.ERROR_REQUIRED:G=x.errorRequiredText;break;case w.ERROR_SHORT:G=x.errorShortText.replace("%s",E.data(w.ATTR_MIN_LENGTH));break;case w.ERROR_DIFFERENT:G=x.errorDifferent;break;case w.ERROR_FILE_SIZE:G=x.errorFileSize;break;case w.ERROR_FILE_TYPE:G=x.errorFileType;break;case w.ERROR_PASSWORD_FORMAT:G=b(C);break;default:case w.ERROR_INVALID:G=x.errorInvalidText;
break}}return G};var d=function(D){var E=v(D),C=E.messageElem,F=E.errorElem;C.addClass("hidden-elem");F.removeClass(x.errorClass)};var k=function(G,I,E,N,H,K){var J=x.elementError(G,I);if(J!==false){var C=v(G);var D=C.messageElem;var M=C.errorElem;M.addClass(x.errorClass);if(!N){if(x.clearErrorsOnChange){$(G).one("focus click",function(O){d(G)})}}if(D.length>0||E){if(I){var F=D.find(".message");if(F.length==0){F=D}var L=c(I,G);if(E!=null&&!N){E.append(x.errorHolderRowFactory(L,G,I,H+1,K))}if($.trim(F.text())==""||F.hasClass("custom")){F.addClass("custom");
F.html(L)}D.removeClass("hidden-elem");if(!N){if(x.clearErrorsOnChange){$(this).one("focus change click",function(O){d($(this))})}}}}}};var m=function(F,D){var E=x.errorsHolder;if(typeof(E)=="string"){E=$(E)}if(E&&E.length==0){E=null}if(E!=null){E.html("")}var C=$(F);C.each(function(G){k($(this),D[G],E,false,G,C.length)})};this.setLoader=function(C){l=C};this.validate=function(E){var G=B.find("input,textarea,select"),K=[],F=[],I={};B.find("."+x.errorClass.replace(/\s+/g,".")).removeClass(x.errorClass);
B.find("."+x.errorMessageClass).addClass("hidden-elem");for(var H=0;H<G.length;H++){var D=$(G[H]);try{if(!a(D)){continue}var L=z(D);if(D.is("input[type=radio]")&&!D.prop("checked")){continue}var C=D.attr("name");if(typeof(C)!=q&&(L!=""||x.sendEmptyOptionalField)){if(D.is("[data-"+this.ATTR_PREFIX+"]")){L=D.data(this.ATTR_PREFIX)+L}I[C]=L}}catch(J){K.push(D);F.push(J.toString())}}if(K.length==0){var M=x.valid(I);if(M!==false&&E!==true){y(I)}return M}else{var M=x.invalid(K,F);if(M!==false){m(K,F)}}return false
};this.listen=function(C){B.find("input,textarea,select").on("keyup change",function(){var F=$(this),G=$.trim(F.val());d(F);if(G==""){return}try{z(F)}catch(D){var E=C?D.toString():null;k(F,E,null,true,0,0)}})};var y=function(C){if(l!=null){l.addVariables(C);l.load()}else{if(x.sendFormOnValidation==false){return}if(x.serverURL!=null){j(r(x.serverURL),C,x.requestType)}else{B.submit()}}};var r=function(C){if(x.httpsCheck){var D=document.location.protocol=="https:";if(D&&C.match(/^http\:/i)){C=C.replace(/^http\:/i,"");
if(C.match(/^\/\//i)){C="https:"+C}}}return C};this.getOption=function(C){if(typeof(x[C])!="undefined"){return x[C]}return null};this.set=function(C,D){x[C]=D};this.setOptions=function(C){x=$.extend(x,C)};this.simulateError=function(D,C){m(D,C)};var p=function(C){h();if(x.success(C)===false){return}if(x.successVisual!=null){$(x.successVisual).show()}else{B.parent().addClass("success")}};var u=function(C,E,D){h();if(x.error(C,E,D)===false){return}};var o=function(){B.parent().addClass("loading")};
var h=function(){B.parent().removeClass("loading")};var j=function(C,E,D){$.ajax({type:D,data:E,url:C,success:p,error:u});o()};s(A)};FormManager.validateElem=function(f,l,b){var a=function(m){return typeof(m)!==undefined};if(b==null){b=new FormManager("",{})}var j=b.getFormElement();if(l==null){l=false}var k=$.trim(f.val());if(f.is("input[type=hidden]:not([data-"+b.ATTR_VALIDATION_TYPE+"])")||f.hasClass(b.getOption("skipValidationClass"))){return k}if(f.is("input[type='checkbox']")){k=f.is(":checked")?b.getOption("checkboxCheckedValue"):b.getOption("checkboxNotCheckedValue")
}var g=f.data(b.ATTR_REQUIRE);g=g=="true"||g=="1";if(g){if(f.is("select")){if(k==b.SELECTBOX_NO_VALUE||k==""){if(!l){return false}throw (b.ERROR_REQUIRED)}}else{if(f.is("input[type=checkbox]")){if(k==b.getOption("checkboxNotCheckedValue")){if(!l){return false}throw (b.ERROR_REQUIRED)}}else{if(f.is("input[type=radio]")){var d=j.find("input[type=radio][name="+f.attr("name")+"]:checked");if(d.length==0){if(!l){return false}throw (b.ERROR_REQUIRED)}}else{if(k==""){if(!l){return false}throw (b.ERROR_REQUIRED)
}}}}}else{var h=f.data(b.ATTR_VALIDATION_TYPE)=="same";if(!h&&(k==""||(f.is("select")&&k==b.SELECTBOX_NO_VALUE))){return""}}var c=f.data(b.ATTR_MIN_LENGTH);if(a(c)){if(k.length<c){if(!l){return false}throw (b.ERROR_SHORT)}}if(f.is("[data-"+b.ATTR_VALIDATION_TYPE+"]")){var i=f.data(b.ATTR_VALIDATION_TYPE);if(i!=b.VALIDATION_TYPE_NONE){var e={type:b.ERROR_INVALID};if(FormManager.Validator.check(i,k,f,e)==false){if(!l){return false}throw e.type}}}return k};FormManager.Validator={PHONE_PREFIX_PATTERN:"0(5[0,2,3,4,7,8,9,5]|7[2,3,4,6,7,8]|[2,3,4,8,9])",addCustomValidation:function(a,b){var c=FormManager.Validator.getFuncName(a);
if(this[c]===undefined){this[c]=b}},getFuncName:function(a){return"is"+a.toLowerCase().ucfirst().replace(/[\s\-\.\_]/gi,"")},check:function(g,j,c,b){var e=g.split(",");var h=true;for(var d in e){var f=this.getFuncName(e[d]);if(typeof(FormManager.Validator[f])=="undefined"){continue}var a=FormManager.Validator[f].apply(this,[j,c,b]);if(!a){h=false;break}}return h},isEmail:function(b){var a=/^[_a-z0-9-]+(\.[_a-z0-9-]+)*@[a-z0-9-]+(\.[a-z0-9-]+)*(\.[a-z]{2,4})$/i;return a.test($.trim(b))},isFullPhone:function(b){var a=new RegExp("^"+FormManager.Validator.PHONE_PREFIX_PATTERN+"[2-9]\\d{6}$");
return a.test(b)},isFullPhoneExtended:function(b){var a=new RegExp("^"+FormManager.Validator.PHONE_PREFIX_PATTERN+"[-s.]?[2-9]\\d{6}$");return a.test(b)},isPhone:function(b){var a=/^[2-9]\d{6}$/;return a.test(b)},isPhonePrefix:function(b){var a=new RegExp("^"+FormManager.Validator.PHONE_PREFIX_PATTERN+"$");return a.test(b)},isIsraeliId:function(d){if(isNaN(d)){return false}var a=d.toString();if(a.length>9||a.length<2){return false}var c=0;var e=9-a.length;for(var b=e;b<8;b++){var d=parseInt(a[b-e])*((b%2)+1);
c+=(d%10+Math.floor(d/10))}return parseInt(a[8-e])==(10-c%10)%10},isName:function(b){var a=/^\s*[a-zא-ת][a-zא-ת\']+([\-\s][a-zא-ת]+)*\s*$/i;return a.test(b)},isFullName:function(b){var a=b.indexOf(" ");if(a<0){return false}var c=[b.slice(0,a),b.slice(a+1)];return this.isName(c[0])&&this.isName(c[1])},isFullname:function(a){return this.isFullName(a)},isZipcode:function(a){return/^[\d]{5}(\d{2})?$/.test(a)},isNumeric:function(b){var a=/^\d+$/;return a.test(b)},isAlphanumeric:function(b){var a=/^[\da-zA-Z]+$/;
return a.test(b)},isAlnum:function(a){return FormManager.Validator.isAlphanumeric(a)},isFloat:function(b){var a=/^\d*\.?\d+$/;return a.test(b)},isDatetime:function(b){var a=/^\d{4}\-\d{2}\-\d{2} \d{2}:\d{2}:\d{2}$/;return a.test(b)},isColor:function(b){var a=/^[a-f0-9]{6}$/i;return a.test(b)},isMD5:function(b){var a=/^[a-f0-9]{32}$/i;return a.test(b)},isUrl:function(b){var a=/^(http[s]?:\/\/){0,1}(www\.){0,1}[a-zA-Z0-9\.\-]+\.[a-zA-Z]{2,5}[\.]{0,1}$/i;return a.test(b)},isBoolean:function(a){return a==="1"||a==="0"||a===1||a===0||a===true||a===false
},isSame:function(c,b,a){a.type="different";if(!b.is("[data-same-as]")){return false}var d=$("#"+b.data("same-as")).val();return d==c},isYoutube:function(b){var a=/^https?\:\/\/([\w\.]*\.)?youtube\.com\/watch\?.*v\=[\w\-]{4,20}(\&|$).*/i;return a.test(b)},isSelector:function(c,b){var a=$(b).data("valid-selector");if(a){return $(b).is(a)}alert("must set data-valid-selector for selector validation type");return false},isPassword:function(g,e,c){var d="";var a={upper:/[A-Z]/,lower:/[a-z]/,digit:/\d/,punc:/[\!\@\#\$\%\^\&\*\(\)\[\]\{\}\.\~\']/};
var f=$(e).data("passformat");for(var b in a){if(f.match(a[b])&&!g.match(a[b])){d+=" #"+b+"#"}}if(d!=""){c.type="format"+d;return false}return true},isFile:function(l,d,c){if(d.length<1){return true}var k=d[0].files;if(typeof(k)=="undefined"||k===null||k.length<1){return true}k=k[0];var g=$(d).data("maxsize");var h=$(d).data("extensions");var e=$(d).data("mime");alert(e);if(h&&typeof(k.name)!="undefined"){var b=/(?:\.([^.]+))?$/.exec(k.name)[1];c.type="file_type";if(!b){return false}b=b.toLowerCase();
if(typeof(h)=="string"){h=h.split(",")}var j=false;for(var f in h){if($.trim(h[f].toLowerCase())==b){j=true;break}}if(!j){return false}}if(e&&typeof(k.type)!="undefined"){alert(k.type);c.type="file_type";var a=k.type.toLowerCase();if(typeof(e)=="string"){e=e.split(",")}var j=false;for(var f in e){if($.trim(e[f].toLowerCase())==a){j=true;break}}if(!j){return false}}if(!isNaN(g)&&typeof(k.size)!="undefined"&&!isNaN(k.size)){if(g<k.size){c.type="file_size";return false}}return true}};String.prototype.ucfirst=function(){return this.replace(/(^|\s|\-|\.)([a-z])/g,function(a,c,b){return c+b.toUpperCase()
})};FormManager.submitHandler=function(c,a){a=a||{};a.sendFormOnValidation=false;var b=new FormManager(c,a);return b.validate()};window.console=window.console||{log:function(){}};(function(a){a.fn.formsInit=function(c,d){var e=a(this);var b=[];e.each(function(){c=c||{};var h=a(this).attr("target"),g=a(this).attr("action");if(g){c.serverURL=g}if(h){c.serverURL=null}var f=new FormManager(this,c);if(d){f.listen()}this.onsubmit=function(k){var j=this.target=="";var i=f.validate(!j);i=i&&!j;if(!i&&k){if(typeof(k.returnValue)!=="undefined"){k.returnValue=false
}if(typeof(k.preventDefault)!=="undefined"){k.preventDefault()}}return i};b.push(f)})}})(jQuery);